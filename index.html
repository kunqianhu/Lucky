<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Emoji Slot Machine</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    padding-top: 50px;
    background-color: #fef6f0;
  }
  .slot-machine {
    display: inline-block;
    font-size: 50px;
    border: 4px solid #333;
    padding: 20px;
    border-radius: 10px;
    background-color: #fff;
  }
  .reels {
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
  }
  .reel-container {
    width: 80px;
    height: 80px;
    overflow: hidden;
    border: 2px solid #333;
    margin: 0 5px;
    border-radius: 8px;
    background-color: #e0e0e0;
    position: relative;
  }
  .reel {
    display: flex;
    flex-direction: column;
    position: absolute;
    top: 0;
    width: 100%;
  }
  .reel span {
    height: 80px;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: transform 0.3s;
  }
  button {
    font-size: 20px;
    padding: 10px 20px;
    cursor: pointer;
  }
  .message {
    margin-top: 20px;
    font-size: 24px;
    font-weight: bold;
  }
  .coins {
    margin-top: 10px;
    font-size: 20px;
    transition: color 0.3s;
  }
  .win {
    animation: bounce 0.5s ease 0s 3, sparkle 1s ease infinite;
  }
  @keyframes bounce {
    0% { transform: scale(1); }
    50% { transform: scale(1.3); }
    100% { transform: scale(1); }
  }
  @keyframes sparkle {
    0%,100% { text-shadow: 0 0 0 #fff; }
    25% { text-shadow: 0 0 8px gold, 0 0 12px yellow; }
    50% { text-shadow: 0 0 12px gold, 0 0 20px yellow; }
    75% { text-shadow: 0 0 8px gold, 0 0 12px yellow; }
  }
  @keyframes coinFlash {
    0% { color: #333; }
    50% { color: gold; text-shadow: 0 0 10px gold, 0 0 20px yellow; }
    100% { color: #333; }
  }
  .flash {
    animation: coinFlash 0.5s ease;
  }
</style>
</head>
<body>

<h1>üé∞ Emoji Slot Machine üé∞</h1>

<div class="slot-machine">
  <div class="reels">
    <div class="reel-container"><div class="reel" id="reel1"></div></div>
    <div class="reel-container"><div class="reel" id="reel2"></div></div>
    <div class="reel-container"><div class="reel" id="reel3"></div></div>
  </div>
  <button id="spinButton">Spin! (-50 coins)</button>
  <div class="message" id="message"></div>
  <div class="coins" id="coins">üí∞ Coins: 1000</div>
</div>

<script>
const emojis = ["üç¨","üçß","üå∑","üçÑ","üçÄ","ü¶ã","ü¶Ñ"];
let coins = 1000;

function spin() {
  if (coins < 50) {
    document.getElementById("message").textContent = "Not enough coins! üíî";
    return;
  }
  coins -= 50;
  document.getElementById("coins").textContent = `üí∞ Coins: ${coins}`;

  const reels = [document.getElementById("reel1"), document.getElementById("reel2"), document.getElementById("reel3")];
  const coinDisplay = document.getElementById("coins");

  // Decide final emojis first
  let finalEmojis = [];
  let isJackpot = Math.random() < 0.05; // 5% jackpot
  if (isJackpot) {
    const jackpotEmoji = emojis[Math.floor(Math.random() * emojis.length)];
    finalEmojis = [jackpotEmoji, jackpotEmoji, jackpotEmoji];
  } else {
    for (let i = 0; i < 3; i++) {
      finalEmojis.push(emojis[Math.floor(Math.random() * emojis.length)]);
    }
  }

  // Fill reels with random emojis for scrolling effect
  reels.forEach((reel, idx) => {
    reel.innerHTML = "";
    for (let i = 0; i < 30; i++) {
      const span = document.createElement("span");
      span.textContent = (i === 29) ? finalEmojis[idx] : emojis[Math.floor(Math.random() * emojis.length)];
      reel.appendChild(span);
    }
  });

  // Animate reels
  reels.forEach((reel, idx) => {
    const duration = 2000 + idx * 400;
    reel.style.transition = `transform ${duration}ms cubic-bezier(0.33, 1, 0.68, 1)`;
    reel.style.transform = `translateY(-${29 * 80}px)`;
  });

  // Check win after longest reel animation
  setTimeout(() => {
    const message = document.getElementById("message");
    // Clear previous win classes
    reels.forEach(r => r.lastChild.classList.remove("win"));

    let winOccurred = false;

    if (finalEmojis[0] === finalEmojis[1] && finalEmojis[1] === finalEmojis[2]) {
      message.textContent = "üéâ JACKPOT! +500 coins! üéâ";
      message.style.color = "green";
      coins += 500;
      reels.forEach(r => r.lastChild.classList.add("win"));
      winOccurred = true;
    } else if (
      (finalEmojis[0] === finalEmojis[1] && finalEmojis[0] !== finalEmojis[2]) ||
      (finalEmojis[1] === finalEmojis[2] && finalEmojis[1] !== finalEmojis[0]) ||
      (finalEmojis[0] === finalEmojis[2] && finalEmojis[0] !== finalEmojis[1])
    ) {
      message.textContent = "‚ú® Small win! +100 coins! ‚ú®";
      message.style.color = "blue";

      // determine which reels match
      let matchingReels = [];
      if (finalEmojis[0] === finalEmojis[1]) matchingReels = [0,1];
      else if (finalEmojis[1] === finalEmojis[2]) matchingReels = [1,2];
      else if (finalEmojis[0] === finalEmojis[2]) matchingReels = [0,2];

      coins += 100;
      matchingReels.forEach(idx => reels[idx].lastChild.classList.add("win"));
      winOccurred = true;
    } else {
      message.textContent = "Try again!";
      message.style.color = "red";
    }

    document.getElementById("coins").textContent = `üí∞ Coins: ${coins}`;

    // Flash coin display if any win
    if (winOccurred) {
      coinDisplay.classList.add("flash");
      setTimeout(() => coinDisplay.classList.remove("flash"), 500);
    }
  }, 3000);
}

document.getElementById("spinButton").addEventListener("click", spin);

// Initialize reels
document.querySelectorAll(".reel").forEach(reel => {
  reel.innerHTML = emojis.map(e => `<span>${e}</span>`).join("");
});
</script>

</body>
</html>
